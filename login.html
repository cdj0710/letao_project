<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>my</title>
    <link rel="stylesheet" href="./lib/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="./lib/bootstrap-validator/css/bootstrapValidator.css">
    <style>
        body {
            background-color: #222D32;
        }
        .box{
            margin-top: 100px;
        }
    
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <!-- 登陆 -->
            <div class="box col-lg-4 col-lg-offset-4">
                <!-- 面板 -->
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <!-- 标题 -->
                        <h3 class="panel-title text-center">后台管理系统</h3>
                    </div>
                    <!-- 登陆内容 -->
                    <div class="panel-body">
                        <!-- 表单 -->
                        <form class="form-horizontal">
                            <div class="form-group">
                                <label for="usename" class="col-sm-3 control-label">用户名</label>
                                <div class="col-sm-9">
                                    <input type="text" name="username" class="form-control" id="usename" placeholder="请输入用户名">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="Password" class="col-sm-3 control-label">密码</label>
                                <div class="col-sm-9">
                                    <input type="password" name="password" class="form-control" id="Password"
                                        placeholder="请输入密码">
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="col-sm-offset-3 col-sm-8">
                                    <button type="reset" class="btn btn-default">重置</button>
                                    <button type="submit" class="btn btn-primary pull-right">登陆</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="./lib/jquery/jquery.js"></script>
    <script src="./lib/bootstrap/js/bootstrap.js"></script>
    <script src="./lib/bootstrap-validator/js/bootstrapValidator.js"></script>
    <script>
        // console.log($('.panel-body form'));
        
        var $form = $('.panel-body form');
        // 表单验证时的样式
        $form.bootstrapValidator({
            // 校验时的字体图标
            feedbackIcons: {
                // 正确的字体图标
                valid: 'glyphicon glyphicon-thumbs-up',
                // 错误的字体图标
                invalid: 'glyphicon glyphicon-thumbs-down',
                validating: 'glyphicon glyphicon-refresh'
            },
            // 关于表单校验时的提示
            fields: {
                // 关于name 属性是username 的校验
                username: {
                    validators: {
                        //为空的  提示不能为空
                        notEmpty: {
                            message: '用户名不能为空'
                        },
                        // 字体长度  
                        // 设置最大最小长度 
                        // 不符合的提示信息
                        stringLength: {
                            min: 2,
                            max: 6,
                            message: '用户名长度必须在2到6之间'
                        },
                        
                    }
                },
                password: {
                    validators: {
                        //为空的  提示不能为空
                        notEmpty: {
                            message: '密码不能为空'
                        },
                        // 密码长度  
                        // 设置最大最小长度 
                        // 不符合的提示信息
                        stringLength: {
                            min: 6,
                            max: 12,
                            message: '密码长度必须是6-12位'
                        },
                    }
                }
            }
        })
        
        // 表单校验成功时的回调函数
        $form.on('success.form.bv', function (e) {
            // 表单成功, submit 默认是提交表单, 
            // 需求: 表单验证成功, 发送请求, 验证账号和密码是否注册一致再提交表单
            e.preventDefault();
            
            //使用ajax提交逻辑
            $.ajax({
                url:'/employee/employeeLogin',
                type:'post',
                data:$form.serialize(),
                success:function(res){
                    console.log($form.serialize())
                    console.log(res);
                    if(res.success){
                        location.href = 'index.html';
                    }
                    if(res.error == 1001){
                        // alert('密码错误')
                        console.log($('input:password').siblings().eq(1))
                        $('input:password').siblings().eq(1).html(res.message).show();
                        // $('input:text').siblings().eq(1).html('用户名不能为空');
                    }
                    if(res.error == 1000){
                        // alert('用户名错误')
                        $('input:text').siblings().eq(1).html(res.message).show();
                        // $('input:password').siblings().eq(1).html('密码不能为空');
                    }
                    
                }
            })
        });
    </script>
</body>

</html>